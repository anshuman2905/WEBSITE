<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Progress Tracker · Sustainable Farming</title>
  <style>
    :root{
      --bg: #0b1210;
      --panel: #0f1815;
      --panel-2: #101c18;
      --text: #e9f5ee;
      --muted: #9fc7b4;
      --brand: #37d47a;
      --brand-2:#2fb66a;
      --accent:#8ef5c1;
      --warn:#ffcc66;
      --danger:#ff7d7d;
      --ok:#6ef596;
      --shadow: 0 10px 30px rgba(0,0,0,.35), 0 2px 8px rgba(0,0,0,.25);
      --radius-2xl: 20px;
      --radius-xl: 16px;
      --radius-lg: 12px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background: radial-gradient(1200px 800px at 10% -10%, #153226 0%, transparent 60%),
                                 radial-gradient(1600px 1200px at 110% 20%, #0e241b 0%, transparent 55%),
                                 linear-gradient(160deg, #08110e, #0b1210);
      color:var(--text); font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      overflow-x:hidden;
    }
    .wrap{max-width:1200px; margin:0 auto; padding:24px}
    header{
      display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:20px;
    }
    .title{
      display:flex; align-items:center; gap:14px;
    }
    .leaf{
      width:42px; height:42px; border-radius:12px; background:linear-gradient(135deg, #1a4 0%, #2fb66a 70%);
      box-shadow:inset 0 0 10px rgba(255,255,255,.15), var(--shadow);
      display:grid; place-items:center; position:relative; overflow:hidden;
    }
    .leaf:before{
      content:""; position:absolute; inset:0; background:conic-gradient(from 180deg, transparent 0 60deg, rgba(255,255,255,.1) 60deg 120deg, transparent 120deg 360deg);
      animation:spin 10s linear infinite; pointer-events:none;
    }
    @keyframes spin{to{transform:rotate(1turn)}}
    h1{font-size: clamp(20px, 2.4vw, 28px); margin:0; letter-spacing:.2px}
    .subtitle{color:var(--muted); font-size:14px}

    .actions{display:flex; gap:10px; align-items:center}
    .select, .btn{
      background: linear-gradient(180deg, #13231d, #0d1a15);
      border:1px solid #1f3a2f; color:var(--text); padding:10px 12px; border-radius:12px;
      display:inline-flex; align-items:center; gap:8px; cursor:pointer; box-shadow: var(--shadow);
    }
    .btn.primary{ background: linear-gradient(180deg, var(--brand), var(--brand-2)); border:1px solid #1e7b46; color:#062010; font-weight:700 }
    .btn.toggle{ position:relative }
    .btn .ping{ width:8px; height:8px; background:var(--ok); border-radius:999px; box-shadow:0 0 0 0 rgba(110,245,150,.7); animation:ping 2s infinite }
    @keyframes ping{ 0%{box-shadow:0 0 0 0 rgba(110,245,150,.7)} 70%{box-shadow:0 0 0 18px rgba(110,245,150,0)} 100%{box-shadow:0 0 0 0 rgba(110,245,150,0)} }

    /* Layout */
    .grid{
      display:grid; grid-template-columns: 1.25fr 1fr 1fr; gap:16px;
    }
    @media (max-width: 1050px){ .grid{ grid-template-columns:1fr 1fr} }
    @media (max-width: 720px){ .grid{ grid-template-columns:1fr } }

    .card{
      background: radial-gradient(120% 160% at 100% -20%, rgba(55,212,122,.08), transparent 35%),
                  linear-gradient(180deg, var(--panel), var(--panel-2));
      border:1px solid #183828; border-radius: var(--radius-2xl); padding:18px; box-shadow: var(--shadow);
      position:relative; overflow:hidden; isolation:isolate;
    }
    .card h3{ margin:0 0 10px 0; font-size:18px; letter-spacing:.2px }
    .card .hint{ color:var(--muted); font-size:12px }
    .card:hover{ transform: translateY(-2px); transition: transform .25s ease }

    /* Shimmer skeleton for graceful load */
    .skeleton{ position:relative; overflow:hidden; background:linear-gradient(180deg, #0d1713, #0b1411); border-radius:14px; height:12px }
    .skeleton:after{content:""; position:absolute; inset:-2px; background:linear-gradient(90deg, transparent, rgba(255,255,255,.08), transparent);
      animation: shimmer 1.8s infinite;}
    @keyframes shimmer{ to{ transform: translateX(100%) } }

    /* Gauge */
    .gauge{ aspect-ratio: 2 / 1; width:100%; display:grid; place-items:center; position:relative }
    .gauge svg{ width:100%; height:auto; }
    .gauge .value{ position:absolute; bottom:16%; text-align:center }
    .gauge .value .big{ font-size:36px; font-weight:800 }

    /* Donut */
    .donut{ display:grid; place-items:center; position:relative; width:100%; height:260px }
    .donut svg{ width:220px; height:220px }
    .donut .center{ position:absolute; text-align:center }

    /* Progress bars */
    .bar{ height:12px; border-radius:999px; background:#0c1713; border:1px solid #1b3a2b; overflow:hidden; position:relative }
    .bar > i{ display:block; height:100%; width:0%; background: linear-gradient(90deg, #1d9f59, #2ad370); border-right:1px solid rgba(255,255,255,.35); box-shadow: inset 0 0 6px rgba(255,255,255,.2) }

    /* Streak */
    .streak{ display:flex; gap:8px; align-items:center; flex-wrap:wrap }
    .day{ width:32px; height:44px; border-radius:10px; display:grid; place-items:center; background:linear-gradient(180deg, #12231c, #0e1c16); border:1px solid #1b3a2b; position:relative }
    .day.active{ outline:2px solid #2ad370; box-shadow:0 0 20px rgba(55,212,122,.35) inset }
    .day .dot{ width:6px; height:6px; border-radius:999px; position:absolute; top:6px }
    .day.active .dot{ background:var(--ok); box-shadow:0 0 0 10px rgba(110,245,150,0); animation: ping 2.2s infinite }

    /* Badges */
    .badges{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:12px }
    @media (max-width:1050px){ .badges{ grid-template-columns: repeat(6, minmax(0,1fr)) } }
    @media (max-width:720px){ .badges{ grid-template-columns: repeat(3, minmax(0,1fr)) } }
    .badge{
      position:relative; padding:14px; border-radius:16px; border:1px solid #1b3a2b; background:linear-gradient(180deg, #12221b, #0f1c16);
      box-shadow: var(--shadow); transform-style: preserve-3d; transition: transform .3s ease;
    }
    .badge:hover{ transform: perspective(700px) rotateX(6deg) rotateY(-6deg) translateY(-2px) }
    .medal{ width:64px; height:64px; margin:6px auto 8px; border-radius:60px; display:grid; place-items:center; position:relative;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.18), transparent 45%),
                  linear-gradient(180deg, #1a3328, #102219); border:1px solid #244834 }
    .medal:after{ content:""; position:absolute; inset:-2px; border-radius:inherit; background: conic-gradient(from 0deg, rgba(255,255,255,.12), transparent 30%, rgba(255,255,255,.12) 60%, transparent 90%); filter: blur(.5px); mix-blend:screen; opacity:.75 }
    .badge h4{ margin:4px 0 4px; font-size:14px }
    .badge .tiny{ color:var(--muted); font-size:12px }
    .badge.locked{ opacity:.6; filter: grayscale(.35) }

    /* Timeline */
    .timeline{ display:grid; gap:10px; padding-left:6px }
    .item{ display:flex; gap:10px; align-items:flex-start }
    .dot{ width:12px; height:12px; background:var(--brand); border-radius:50%; box-shadow:0 0 0 6px rgba(55,212,122,.08) }
    .item .txt{ font-size:14px }
    .item .time{ color:var(--muted); font-size:12px }

    /* Floating particles */
    .particles { position: fixed; inset: 0; pointer-events: none; z-index: 1; overflow: hidden }
    .particle { position: absolute; width: 6px; height: 6px; background: radial-gradient(circle, var(--accent), transparent 70%); border-radius: 999px; opacity: .25; animation: float 12s linear infinite }
    @keyframes float { to { transform: translateY(-120vh) translateX(20vw) rotate(360deg); } }

    .footer{ display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:12px; margin-top:16px }

    /* Light theme (optional toggle) */
    .light{
      --bg:#f7fcf9; --panel:#ffffff; --panel-2:#f5fbf8; --text:#0d2118; --muted:#416b57; --shadow:0 8px 25px rgba(0, 0, 0, .12);
      background: radial-gradient(1200px 800px at 10% -10%, #e3fff2 0%, transparent 60%),
                  radial-gradient(1600px 1200px at 110% 20%, #e6fff4 0%, transparent 55%),
                  linear-gradient(160deg, #f6fff9, #f4fff8);
    }
  </style>
</head>
<body>
  <div class="particles" aria-hidden="true"></div>

  <div class="wrap">
    <header>
      <div class="title">
        <div class="leaf" aria-hidden="true">
          <svg viewBox="0 0 100 100" width="24" height="24" aria-hidden="true">
            <path d="M73 13c-13 6-24 17-29 28-5 12-5 25-18 39 20 1 33-7 42-16 9-8 15-18 17-30 1-4-4-8-12-21z" fill="#d7ffe8"/>
          </svg>
        </div>
        <div>
          <h1>Progress Tracker</h1>
          <div class="subtitle">Visual dashboards · Sustainability Score · Learning Badges</div>
        </div>
      </div>
      <div class="actions">
        <label class="select" title="Time range">
          <span>Range:</span>
          <select id="range" style="background:transparent; color:rgb(168, 255, 183); border:none; outline:none">
            <option value="7">Last 7 days</option>
            <option value="30" selected>Last 30 days</option>
            <option value="90">Last 90 days</option>
            <option value="365">Last year</option>
          </select>
        </label>
        <button class="btn toggle" id="themeBtn" title="Toggle theme">
          <span class="ping"></span>
          Theme
        </button>
        <button class="btn primary" id="simulateBtn" title="Simulate progress">Simulate Progress</button>
      </div>
    </header>

    <main class="grid" aria-live="polite">
      <!-- LEFT COLUMN -->
      <section class="card" aria-label="Sustainability Score" id="scoreCard">
        <h3>Sustainability Score</h3>
        <div class="hint">Composite of soil health, water use, biodiversity and inputs</div>
        <div class="gauge" role="img" aria-label="Sustainability gauge">
          <svg viewBox="0 0 200 100">
            <!-- track -->
            <path d="M10,100 A90,90 0 0 1 190,100" fill="none" stroke="#1d3a2d" stroke-width="18" stroke-linecap="round"/>
            <!-- progress -->
            <path id="gaugeArc" d="M10,100 A90,90 0 0 1 190,100" fill="none" stroke="url(#grad)" stroke-width="18" stroke-linecap="round" stroke-dasharray="283" stroke-dashoffset="283"/>
            <defs>
              <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" stop-color="#ffb85c"/>
                <stop offset="40%" stop-color="#37d47a"/>
                <stop offset="100%" stop-color="#8ef5c1"/>
              </linearGradient>
            </defs>
          </svg>
          <div class="value">
            <div class="big" id="scoreValue">--</div>
            <div class="hint">out of 100</div>
          </div>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:4px">
          <div>
            <div class="hint">Soil Health</div>
            <div class="bar" aria-label="Soil health progress"><i id="soilBar"></i></div>
          </div>
          <div>
            <div class="hint">Water Efficiency</div>
            <div class="bar" aria-label="Water efficiency progress"><i id="waterBar"></i></div>
          </div>
          <div>
            <div class="hint">Biodiversity</div>
            <div class="bar" aria-label="Biodiversity progress"><i id="bioBar"></i></div>
          </div>
          <div>
            <div class="hint">Input (Organic)</div>
            <div class="bar" aria-label="Organic inputs progress"><i id="inputBar"></i></div>
          </div>
        </div>
      </section>

      <!-- MIDDLE COLUMN -->
      <section class="card" aria-label="Task Completion">
        <h3>Task Completion</h3>
        <div class="hint">Completed vs. total tasks in selected range</div>
        <div class="donut">
          <svg viewBox="0 0 120 120" aria-hidden="true">
            <circle cx="60" cy="60" r="46" fill="#0c1713" stroke="#1c3a2b" stroke-width="12"></circle>
            <circle id="donutArc" cx="60" cy="60" r="46" fill="transparent" stroke="url(#grad)" stroke-width="12" stroke-dasharray="289" stroke-dashoffset="289" stroke-linecap="round" transform="rotate(-90 60 60)"></circle>
          </svg>
          <div class="center">
            <div class="big" id="taskPct">--%</div>
            <div class="hint"><span id="taskDone">0</span>/<span id="taskTotal">0</span> tasks</div>
          </div>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
          <div>
            <div class="hint">XP Earned</div>
            <div class="bar"><i id="xpBar"></i></div>
          </div>
          <div>
            <div class="hint">Weekly Goal</div>
            <div class="bar"><i id="goalBar"></i></div>
          </div>
        </div>
      </section>

      <!-- RIGHT COLUMN -->
      <section class="card" aria-label="Learning Badges">
        <h3>Learning Badges</h3>
        <div class="hint">Earn badges for completing modules and sustainable actions</div>
        <div class="badges" id="badgeGrid">
          <!-- badges injected by JS -->
        </div>
      </section>

      <!-- FULL-WIDTH ROWS -->
      <section class="card" style="grid-column:1 / -1" aria-label="Streak & Recent Activity">
        <h3>Streak & Recent Activity</h3>
        <div class="hint">Keep the momentum going – complete at least one task daily</div>
        <div style="display:grid; grid-template-columns: 2fr 1fr; gap:16px; margin-top:10px">
          <div>
            <div class="streak" id="streakRow" aria-label="Current streak">
              <!-- days injected via JS -->
            </div>
            <div style="margin-top:12px">
              <div class="hint">Overall Mission Progress</div>
              <div class="bar"><i id="missionBar"></i></div>
            </div>
          </div>
          <div>
            <div class="timeline" id="timeline">
              <!-- timeline items -->
            </div>
          </div>
        </div>
      </section>
    </main>

    <div class="footer">
      <div>Tip: Click <b>Simulate Progress</b> to see animations. Use <b>Range</b> to filter.</div>
      <div>© 2025 Navdhara · Sustainable Farming</div>
    </div>
  </div>

  <script>
    // --- Utility helpers ---
    const clamp = (n, min, max) => Math.max(min, Math.min(max, n));
    const byId = (id) => document.getElementById(id);

    // Particles background
    (function makeParticles(){
      const container = document.querySelector('.particles');
      for(let i=0;i<36;i++){
        const p = document.createElement('div');
        p.className = 'particle';
        const size = 4 + Math.random()*8;
        p.style.width = p.style.height = size+'px';
        p.style.left = Math.random()*100+'vw';
        p.style.bottom = (-10 + Math.random()*40)+'vh';
        p.style.animationDelay = (Math.random()*-12)+'s';
        p.style.opacity = 0.12 + Math.random()*0.28;
        container.appendChild(p);
      }
    })();

    // Fake initial data (replace with real API later)
    let data = {
      score: 72,
      soil: 0.78,
      water: 0.62,
      bio: 0.55,
      input: 0.81,
      tasksDone: 18,
      tasksTotal: 24,
      xp: 0.64,
      goal: 0.72,
      mission: 0.58,
      streak: 9,
      timeline: [
        {txt: 'Completed "Mulch your beds" task', time: 'Today'},
        {txt: 'Watched lesson: Mixed Cropping Basics', time: 'Yesterday'},
        {txt: 'Logged 500L water saved with drip', time: '2 days ago'},
        {txt: 'Organic inputs used: Neem oil', time: '4 days ago'},
      ],
      badges: [
        {title:'Soil Saver', tier:'Bronze', unlocked:true},
        {title:'Water Wise', tier:'Silver', unlocked:true},
        {title:'Biodiversity Buddy', tier:'Locked', unlocked:false},
        {title:'Organic Champ', tier:'Gold', unlocked:true},
        {title:'Carbon Cutter', tier:'Locked', unlocked:false},
        {title:'Compost Guru', tier:'Bronze', unlocked:true},
      ]
    };

    // --- Render functions ---
    function animateArc(elem, value, totalLength){
      const target = clamp( totalLength * (1 - value), 0, totalLength );
      const start = parseFloat(elem.getAttribute('data-offset') || totalLength);
      const startTime = performance.now();
      const dur = 1000 + Math.random()*600;
      function tick(now){
        const t = clamp((now - startTime)/dur, 0, 1);
        const eased = 1 - Math.pow(1 - t, 3); // easeOutCubic
        const cur = start + (target - start) * eased;
        elem.style.strokeDashoffset = cur;
        if(t < 1) requestAnimationFrame(tick); else elem.setAttribute('data-offset', cur);
      }
      requestAnimationFrame(tick);
    }

    function animateBar(elem, value){
      const start = parseFloat(elem.getAttribute('data-w') || 0);
      const end = clamp(value*100, 0, 100);
      const startTime = performance.now();
      const dur = 1000;
      function tick(now){
        const t = clamp((now - startTime)/dur, 0, 1);
        const eased = 1 - Math.pow(1 - t, 3);
        const cur = start + (end - start) * eased;
        elem.style.width = cur + '%';
        if(t < 1) requestAnimationFrame(tick); else elem.setAttribute('data-w', cur);
      }
      requestAnimationFrame(tick);
    }

    function renderScore(){
      const arc = byId('gaugeArc');
      animateArc(arc, data.score/100, 283);
      byId('scoreValue').textContent = Math.round(data.score);
      animateBar(byId('soilBar'), data.soil);
      animateBar(byId('waterBar'), data.water);
      animateBar(byId('bioBar'), data.bio);
      animateBar(byId('inputBar'), data.input);
    }

    function renderDonut(){
      const arc = byId('donutArc');
      const pct = (data.tasksDone / Math.max(1, data.tasksTotal));
      animateArc(arc, pct, 289);
      byId('taskPct').textContent = Math.round(pct*100) + '%';
      byId('taskDone').textContent = data.tasksDone;
      byId('taskTotal').textContent = data.tasksTotal;
      animateBar(byId('xpBar'), data.xp);
      animateBar(byId('goalBar'), data.goal);
    }

    function renderBadges(){
      const grid = byId('badgeGrid');
      grid.innerHTML = '';
      data.badges.forEach((b,i)=>{
        const el = document.createElement('div');
        el.className = 'badge' + (b.unlocked ? '' : ' locked');
        el.innerHTML = `
          <div class="medal" aria-hidden="true">
            <svg viewBox="0 0 64 64" width="40" height="40" aria-hidden="true">
              <defs>
                <linearGradient id="g${i}" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="${b.tier==='Gold' ? '#ffd66b' : b.tier==='Silver' ? '#cfe8ff' : '#f9c28b'}"/>
                  <stop offset="100%" stop-color="${b.tier==='Gold' ? '#ffb200' : b.tier==='Silver' ? '#9cc7ff' : '#e49a58'}"/>
                </linearGradient>
              </defs>
              <circle cx="32" cy="32" r="20" fill="url(#g${i})" stroke="#153924" stroke-width="3" />
              <path d="M22 32h20M32 22v20" stroke="#153924" stroke-width="4" stroke-linecap="round" />
            </svg>
          </div>
          <h4>${b.title}</h4>
          <div class="tiny">${b.unlocked ? b.tier : 'Locked'}</div>
        `;
        grid.appendChild(el);
      })
    }

    function renderStreak(){
      const row = byId('streakRow');
      row.innerHTML = '';
      const days = 14;
      for(let i=0;i<days;i++){
        const d = document.createElement('div');
        const active = days - i <= data.streak;
        d.className = 'day' + (active ? ' active' : '');
        d.innerHTML = `<div class="dot"></div><div>${i+1}</div>;`
        row.appendChild(d);
      }
      animateBar(byId('missionBar'), data.mission);
    }

    function renderTimeline(){
      const t = byId('timeline');
      t.innerHTML = '';
      data.timeline.forEach(item=>{
        const row = document.createElement('div');
        row.className = 'item';
        row.innerHTML = `<div class="dot" aria-hidden="true"></div>
                         <div class="txt">${item.txt}<div class="time">${item.time}</div></div>`;
        t.appendChild(row);
      })
    }

    function confetti(x=window.innerWidth/2, y=window.innerHeight/2){
      const colors = ['#37d47a','#8ef5c1','#ffb85c','#6ef596'];
      for(let i=0;i<24;i++){
        const s = document.createElement('span');
        s.style.cssText = `position:fixed; left:${x}px; top:${y}px; width:8px; height:8px; border-radius:2px; background:${colors[i%colors.length]};
          transform: translate(-50%,-50%); pointer-events:none; z-index:10;`;
        document.body.appendChild(s);
        const dx = (Math.random()*2-1) * 180;
        const dy = - (60 + Math.random()*240);
        const rot = (Math.random()*720-360);
        s.animate([
          { transform:`translate(-50%,-50%) translate(0,0) rotate(0deg) , opacity:1`},
          { transform:`translate(-50%,-50%) translate(${dx}px, ${dy}px) rotate(${rot}deg), opacity:0` }
        ], { duration: 1200 + Math.random()*600, easing:'cubic-bezier(.2,.8,.2,1)' }).onfinish = ()=> s.remove();
      }
    }

    // The one function you’ll wire to real data later
    function setData(next){
      data = { ...data, ...next };
      renderAll();
    }

    function renderAll(){
      renderScore();
      renderDonut();
      renderBadges();
      renderStreak();
      renderTimeline();
    }

    // Simulate updates for demo
    function simulate(){
      const delta = (v, max=1)=> clamp(v + (Math.random()*.2 - .05), 0, max);
      const done = Math.max(0, Math.min(data.tasksTotal, Math.round(data.tasksDone + Math.random()*3)));
      setData({
        score: clamp(Math.round(data.score + (Math.random()*6 - 1.5)), 0, 100),
        soil: delta(data.soil),
        water: delta(data.water),
        bio: delta(data.bio),
        input: delta(data.input),
        tasksDone: done,
        xp: delta(data.xp),
        goal: delta(data.goal),
        mission: delta(data.mission),
        streak: data.streak + (Math.random() > .5 ? 1 : 0),
        timeline: [
          {txt: 'Completed field check-in ✅', time: 'Just now'},
          ...data.timeline.slice(0,5)
        ]
      });
      confetti(window.innerWidth - 120, 80);
    }

    // Theme toggle
    const themeBtn = byId('themeBtn');
    themeBtn.addEventListener('click', ()=>{
      document.body.classList.toggle('light');
    });

    // Range change (demo filter)
    byId('range').addEventListener('change', (e)=>{
      const days = parseInt(e.target.value, 10);
      const scale = days/30; // fake scaling effect
      setData({
        tasksTotal: Math.round(20 * scale + 4),
        tasksDone: Math.round(14 * scale + 2),
        xp: clamp(.5 * scale + .3, 0, 1),
        goal: clamp(.6 * scale + .2, 0, 1),
      });
    });

    // Simulate button
    byId('simulateBtn').addEventListener('click', simulate);

    // Initial render
    renderAll();

    // Expose setter for integration
    window.ProgressTracker = { setData };
  </script>
</body>
</html>